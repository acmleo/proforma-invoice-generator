function createA4Canvas(sourceCanvas) {
    // A4尺寸：210mm × 297mm，在96DPI下约为794×1123像素
    const a4Width = 794;
    const a4Height = 1123;
    
    // 创建A4尺寸的画布
    const a4Canvas = document.createElement('canvas');
    a4Canvas.width = a4Width;
    a4Canvas.height = a4Height;
    const a4Ctx = a4Canvas.getContext('2d');
    
    // 设置白色背景
    a4Ctx.fillStyle = '#ffffff';
    a4Ctx.fillRect(0, 0, a4Width, a4Height);
    
    // 计算边距（四周各5px）
    const margin = 5;
    const contentWidth = a4Width - (margin * 2);
    const contentHeight = a4Height - (margin * 2);
    
    // 计算缩放比例，保持内容比例，同时适应A4内容区域
    const scale = Math.min(
        contentWidth / sourceCanvas.width,
        contentHeight / sourceCanvas.height
    );
    
    // 计算居中位置
    const scaledWidth = sourceCanvas.width * scale;
    const scaledHeight = sourceCanvas.height * scale;
    const x = margin + (contentWidth - scaledWidth) / 2;
    const y = margin + (contentHeight - scaledHeight) / 2;
    
    // 绘制到A4画布上
    a4Ctx.drawImage(sourceCanvas, x, y, scaledWidth, scaledHeight);
    
    return a4Canvas;
}
